{"id":"mdindex-2jm","title":"Add EmbeddingRepository diagnostic extensions","description":"Add methods: count_distinct_embedded_hashes(), count_documents_missing_embeddings(), list_paths_missing_embeddings(), count_orphaned_embeddings(), delete_orphaned_embeddings().","status":"open","priority":2,"issue_type":"task","owner":"mike@mikewaters.net","created_at":"2026-01-11T17:03:06.545085-05:00","created_by":"Mike Waters","updated_at":"2026-01-11T17:03:06.545085-05:00"}
{"id":"mdindex-3vb","title":"Refactor LoadingService and pipelines to use repository methods","description":"Replace _get_document_id() in loading.py, ingestion.py, embedding.py with DocumentRepository.get_id(). Replace _list_embed_targets() with DocumentRepository.list_active_with_content().","status":"open","priority":2,"issue_type":"task","owner":"mike@mikewaters.net","created_at":"2026-01-11T17:03:07.743-05:00","created_by":"Mike Waters","updated_at":"2026-01-11T17:03:07.743-05:00","dependencies":[{"issue_id":"mdindex-3vb","depends_on_id":"mdindex-abu","type":"blocks","created_at":"2026-01-11T17:03:28.780632-05:00","created_by":"Mike Waters"}]}
{"id":"mdindex-5ip","title":"Unit tests for new repository methods","description":"Add unit tests for all new repository methods: ContentRepository (2 methods), DocumentRepository (7 methods), EmbeddingRepository (5 methods), FTS5SearchRepository (3 methods).","status":"open","priority":2,"issue_type":"task","owner":"mike@mikewaters.net","created_at":"2026-01-11T17:03:08.597131-05:00","created_by":"Mike Waters","updated_at":"2026-01-11T17:03:08.597131-05:00","dependencies":[{"issue_id":"mdindex-5ip","depends_on_id":"mdindex-pru","type":"blocks","created_at":"2026-01-11T17:03:29.261734-05:00","created_by":"Mike Waters"},{"issue_id":"mdindex-5ip","depends_on_id":"mdindex-abu","type":"blocks","created_at":"2026-01-11T17:03:29.347868-05:00","created_by":"Mike Waters"},{"issue_id":"mdindex-5ip","depends_on_id":"mdindex-2jm","type":"blocks","created_at":"2026-01-11T17:03:29.456302-05:00","created_by":"Mike Waters"},{"issue_id":"mdindex-5ip","depends_on_id":"mdindex-eg5","type":"blocks","created_at":"2026-01-11T17:03:29.538844-05:00","created_by":"Mike Waters"}]}
{"id":"mdindex-5r1","title":"Refactor CLI collection command to use repository methods","description":"Replace direct SQL in collection.py show_collection() with DocumentRepository.count_active() and count_active_with_embeddings().","status":"open","priority":2,"issue_type":"task","owner":"mike@mikewaters.net","created_at":"2026-01-11T17:03:08.319695-05:00","created_by":"Mike Waters","updated_at":"2026-01-11T17:03:08.319695-05:00","dependencies":[{"issue_id":"mdindex-5r1","depends_on_id":"mdindex-abu","type":"blocks","created_at":"2026-01-11T17:03:28.946207-05:00","created_by":"Mike Waters"}]}
{"id":"mdindex-85v","title":"Refactor StatusService to use repository methods","description":"Replace all self._db.execute() calls in status.py with repository methods. Affects get_index_status(), get_collection_stats(), get_index_sync_report().","status":"open","priority":2,"issue_type":"task","owner":"mike@mikewaters.net","created_at":"2026-01-11T17:03:07.159057-05:00","created_by":"Mike Waters","updated_at":"2026-01-11T17:03:07.159057-05:00","dependencies":[{"issue_id":"mdindex-85v","depends_on_id":"mdindex-abu","type":"blocks","created_at":"2026-01-11T17:03:27.846202-05:00","created_by":"Mike Waters"},{"issue_id":"mdindex-85v","depends_on_id":"mdindex-2jm","type":"blocks","created_at":"2026-01-11T17:03:27.926958-05:00","created_by":"Mike Waters"},{"issue_id":"mdindex-85v","depends_on_id":"mdindex-eg5","type":"blocks","created_at":"2026-01-11T17:03:28.007538-05:00","created_by":"Mike Waters"}]}
{"id":"mdindex-abu","title":"Add DocumentRepository query extensions","description":"Add methods: count_active(), get_id(), get_ids_by_paths(), list_active_with_content(), get_search_rows_by_ids(), list_for_metadata_backfill(), count_active_with_embeddings(). Define BackfillRow and DocumentSearchRow types.","status":"open","priority":2,"issue_type":"task","owner":"mike@mikewaters.net","created_at":"2026-01-11T17:03:06.268354-05:00","created_by":"Mike Waters","updated_at":"2026-01-11T17:03:06.268354-05:00"}
{"id":"mdindex-arn","title":"Integration tests for refactored services","description":"Verify existing service tests pass after refactoring. Add integration tests confirming StatusService, IndexingService, LoadingService produce identical results using repository methods.","status":"open","priority":2,"issue_type":"task","owner":"mike@mikewaters.net","created_at":"2026-01-11T17:03:08.89763-05:00","created_by":"Mike Waters","updated_at":"2026-01-11T17:03:08.89763-05:00","dependencies":[{"issue_id":"mdindex-arn","depends_on_id":"mdindex-85v","type":"blocks","created_at":"2026-01-11T17:03:29.853932-05:00","created_by":"Mike Waters"},{"issue_id":"mdindex-arn","depends_on_id":"mdindex-e6d","type":"blocks","created_at":"2026-01-11T17:03:29.939152-05:00","created_by":"Mike Waters"},{"issue_id":"mdindex-arn","depends_on_id":"mdindex-3vb","type":"blocks","created_at":"2026-01-11T17:03:30.021926-05:00","created_by":"Mike Waters"},{"issue_id":"mdindex-arn","depends_on_id":"mdindex-qj0","type":"blocks","created_at":"2026-01-11T17:03:30.10644-05:00","created_by":"Mike Waters"},{"issue_id":"mdindex-arn","depends_on_id":"mdindex-5r1","type":"blocks","created_at":"2026-01-11T17:03:30.188535-05:00","created_by":"Mike Waters"}]}
{"id":"mdindex-e6d","title":"Refactor IndexingService to use repository methods","description":"Replace direct SQL in cleanup_orphans() with ContentRepository/EmbeddingRepository. Replace _get_document_id() with DocumentRepository.get_id(). Replace backfill_metadata() queries with DocumentRepository.list_for_metadata_backfill().","status":"open","priority":2,"issue_type":"task","owner":"mike@mikewaters.net","created_at":"2026-01-11T17:03:07.460211-05:00","created_by":"Mike Waters","updated_at":"2026-01-11T17:03:07.460211-05:00","dependencies":[{"issue_id":"mdindex-e6d","depends_on_id":"mdindex-pru","type":"blocks","created_at":"2026-01-11T17:03:28.310855-05:00","created_by":"Mike Waters"},{"issue_id":"mdindex-e6d","depends_on_id":"mdindex-abu","type":"blocks","created_at":"2026-01-11T17:03:28.393029-05:00","created_by":"Mike Waters"},{"issue_id":"mdindex-e6d","depends_on_id":"mdindex-2jm","type":"blocks","created_at":"2026-01-11T17:03:28.470203-05:00","created_by":"Mike Waters"}]}
{"id":"mdindex-eg5","title":"Add FTS5SearchRepository diagnostic extensions","description":"Add methods: count_documents_missing_fts(), list_paths_missing_fts(), count_orphaned_fts_rows().","status":"open","priority":2,"issue_type":"task","owner":"mike@mikewaters.net","created_at":"2026-01-11T17:03:06.838685-05:00","created_by":"Mike Waters","updated_at":"2026-01-11T17:03:06.838685-05:00"}
{"id":"mdindex-j6q","title":"Remove direct SQL usage outside pmd.store","description":"Consolidate all direct SQL usage into the repository layer under pmd.store to support SQLAlchemy transition. See features/remove-direct-sql-usage.md for full plan.","status":"open","priority":2,"issue_type":"epic","owner":"mike@mikewaters.net","created_at":"2026-01-11T17:02:42.542911-05:00","created_by":"Mike Waters","updated_at":"2026-01-11T17:02:48.938769-05:00","dependencies":[{"issue_id":"mdindex-j6q","depends_on_id":"mdindex-pru","type":"blocks","created_at":"2026-01-11T17:04:38.085045-05:00","created_by":"Mike Waters"},{"issue_id":"mdindex-j6q","depends_on_id":"mdindex-abu","type":"blocks","created_at":"2026-01-11T17:04:38.165973-05:00","created_by":"Mike Waters"},{"issue_id":"mdindex-j6q","depends_on_id":"mdindex-2jm","type":"blocks","created_at":"2026-01-11T17:04:38.244855-05:00","created_by":"Mike Waters"},{"issue_id":"mdindex-j6q","depends_on_id":"mdindex-eg5","type":"blocks","created_at":"2026-01-11T17:04:38.32489-05:00","created_by":"Mike Waters"},{"issue_id":"mdindex-j6q","depends_on_id":"mdindex-arn","type":"blocks","created_at":"2026-01-11T17:04:38.404893-05:00","created_by":"Mike Waters"}]}
{"id":"mdindex-pru","title":"Add ContentRepository with orphan cleanup methods","description":"New repository for content table: count_orphaned_content(), delete_orphaned_content(). Used by IndexingService.cleanup_orphans().","status":"open","priority":2,"issue_type":"task","owner":"mike@mikewaters.net","created_at":"2026-01-11T17:03:05.993417-05:00","created_by":"Mike Waters","updated_at":"2026-01-11T17:03:05.993417-05:00"}
{"id":"mdindex-qj0","title":"Refactor search/metadata modules to use repository methods","description":"Replace document-details join in retrieval.py with DocumentRepository.get_search_rows_by_ids(). Replace build_path_to_id_map() in scoring.py with DocumentRepository.get_ids_by_paths(). Also refactor boost.py.","status":"open","priority":2,"issue_type":"task","owner":"mike@mikewaters.net","created_at":"2026-01-11T17:03:08.025558-05:00","created_by":"Mike Waters","updated_at":"2026-01-11T17:03:08.025558-05:00","dependencies":[{"issue_id":"mdindex-qj0","depends_on_id":"mdindex-abu","type":"blocks","created_at":"2026-01-11T17:03:28.863782-05:00","created_by":"Mike Waters"}]}
